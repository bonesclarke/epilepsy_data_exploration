# Rhythmic Features Documentation

## Overview

Rhythmic features capture the power and characteristics of specific EEG frequency bands using time-domain filtering approaches. Unlike spectral analysis that provides full frequency decomposition, this method focuses on key physiological rhythms and their relationships, along with spike detection for identifying transient high-amplitude events.

## Signal Processing Method

### Butterworth Bandpass Filtering
- **Filter Type**: 4th order Butterworth bandpass filter
- **Design Characteristics**:
  - Maximally flat frequency response in passband
  - No ripples in passband or stopband
  - Smooth roll-off at cutoff frequencies
  - 24 dB/octave attenuation rate

- **Implementation**: 
  - Forward-backward filtering (filtfilt) for zero phase distortion
  - Preserves temporal relationships between channels
  - Doubles effective filter order (8th order total)

## Frequency Bands Analyzed

### Theta Rhythm (3.5-8 Hz)
**Features:** `rhythmic_theta_power_mean`, `rhythmic_theta_power_std`

- **Neural Generators**: 
  - Hippocampus (memory processing)
  - Medial temporal structures
  - Frontal midline regions (cognitive control)

- **Functional Significance**:
  - Memory encoding and retrieval
  - Spatial navigation
  - REM sleep
  - Emotional regulation

- **Power Calculation**: Mean squared amplitude of filtered signal
- **Scaling**: Multiplied by 10⁸ for numerical stability

### Delta/Slow Rhythm (0.5-3.5 Hz)
**Features:** `rhythmic_delta_slow_power_mean`, `rhythmic_delta_slow_power_std`

- **Neural Characteristics**:
  - Largest amplitude EEG waves
  - Generated by thalamocortical circuits
  - Dominant in deep sleep (stages 3-4)

- **Clinical Relevance**:
  - Sleep depth indicator
  - Brain injury marker (focal delta)
  - Encephalopathy indicator
  - Developmental marker in children

- **Pathological Patterns**:
  - Focal delta: Structural lesions
  - Diffuse delta: Metabolic encephalopathy
  - Intermittent delta: Epileptogenic regions

### Fast/Beta Rhythm (13-30 Hz)
**Features:** `rhythmic_fast_power_mean`, `rhythmic_fast_power_std`

- **Neural Basis**:
  - Cortical and subcortical networks
  - Motor cortex activation
  - GABAergic interneuron activity

- **Functional Associations**:
  - Motor planning and execution
  - Active concentration
  - Anxious states
  - Medication effects (benzodiazepines, barbiturates)

- **Clinical Indicators**:
  - Increased: Anxiety, medications, active thinking
  - Decreased: Parkinson's disease (off medication)
  - Asymmetry: Focal pathology

## Spike Detection

### Threshold-Based Detection Method
**Features:** `rhythmic_spike_rate_mean`, `rhythmic_spike_rate_std`

- **Detection Algorithm**:
  1. Calculate channel standard deviation (σ)
  2. Set threshold = 3σ
  3. Identify samples where |amplitude| > threshold
  4. Count spikes per second

- **Interpretation**:
  - Detects high-amplitude transients
  - Sensitive to epileptiform discharges
  - May include artifacts (eye blinks, muscle)

- **Spike Rate Metrics**:
  - **Mean**: Average spikes/second across channels
  - **Std**: Spatial variability of spike occurrence
  - Normal EEG: <1 spike/second
  - Epileptiform activity: >5 spikes/second

### Clinical Significance of Spikes
- **Interictal spikes**: Between seizures
- **Ictal spikes**: During seizures
- **Benign variants**: Normal sharp transients
- **Artifacts**: Non-cerebral high-amplitude events

## Rhythm Power Ratios

### Theta/Delta Ratio
**Feature:** `rhythmic_theta_delta_ratio`

- **Calculation**: mean(theta_power) / mean(delta_slow_power)
- **Interpretation**:
  - **High ratio (>1)**: Increased theta relative to delta
    - Light sleep or drowsiness
    - Memory processing
    - Cognitive engagement
  - **Low ratio (<0.5)**: Increased delta relative to theta
    - Deep sleep
    - Encephalopathy
    - Brain injury

- **Clinical Applications**:
  - Sleep stage classification
  - Consciousness level assessment
  - Cognitive function monitoring

### Fast/Theta Ratio
**Feature:** `rhythmic_fast_theta_ratio`

- **Calculation**: mean(fast_power) / mean(theta_power)
- **Interpretation**:
  - **High ratio (>2)**: Beta dominance
    - Alert, anxious state
    - Medication effects
    - Active concentration
  - **Low ratio (<0.5)**: Theta dominance
    - Drowsiness
    - Memory processing
    - Meditative states

- **Clinical Relevance**:
  - Attention assessment
  - Anxiety level monitoring
  - Medication response

## Channel Statistics

### Power Aggregation
Each rhythm's power is calculated per channel, then aggregated:

- **Mean Power** (`_mean`): 
  - Average power across all channels
  - Global brain activity in that rhythm
  - Scaled by 10⁸ for numerical representation

- **Standard Deviation** (`_std`):
  - Spatial variability of rhythm power
  - Higher values indicate focal activity
  - Lower values suggest diffuse patterns

## Clinical Applications

### Seizure Detection and Classification
- **Ictal Patterns**:
  - Increased spike rate (>10/second)
  - Rhythmic theta or delta activity
  - Evolving frequency patterns
  - Altered rhythm ratios

- **Seizure Types**:
  - Absence: 3 Hz spike-wave (delta range)
  - Temporal lobe: Rhythmic theta
  - Generalized tonic-clonic: Fast activity transitioning to slow

### Sleep Analysis
- **Stage Indicators**:
  - N3 (deep sleep): High delta power
  - REM: High theta, low delta
  - N1/N2: Mixed frequencies
  - Wake: High beta, low delta

### Cognitive Assessment
- **Memory Tasks**: Increased theta
- **Attention Tasks**: Increased beta
- **Relaxation**: Decreased beta/theta ratio
- **Mental Fatigue**: Increased delta

### Pathological States

#### Encephalopathy
- Increased delta power
- Decreased fast rhythms
- Low theta/delta ratio
- Reduced spike rate

#### Epilepsy
- Focal rhythm abnormalities
- Increased spike rate
- Abnormal rhythm ratios
- Asymmetric power distribution

#### Neurodegenerative Diseases
- Slowing of background rhythms
- Reduced beta power
- Increased delta/theta
- Loss of reactivity

## Advantages of Rhythmic Features

### Computational Efficiency
- Simple time-domain filtering
- No FFT required
- Real-time capable
- Low memory footprint

### Clinical Interpretability
- Direct correspondence to EEG rhythms
- Well-established clinical significance
- Visual EEG correlation
- Standardized frequency bands

### Robustness
- Less affected by window artifacts
- Phase-preserving filtering
- Handles short segments
- Works with standard sampling rates

## Limitations and Considerations

### Filter Characteristics
- **Transition bands**: Gradual roll-off at boundaries
- **Edge effects**: Artifacts at segment boundaries
- **Filter delay**: Compensated by filtfilt
- **Frequency resolution**: Limited to predefined bands

### Spike Detection Limitations
- **Sensitivity**: May miss low-amplitude spikes
- **Specificity**: May detect artifacts as spikes
- **Threshold dependency**: Fixed 3σ may not suit all conditions
- **No morphology analysis**: Cannot distinguish spike types

### Power Estimation
- **Assumes stationarity**: Within filtered segment
- **No frequency resolution**: Within bands
- **Amplitude dependent**: Affected by recording parameters
- **Reference dependent**: Montage affects absolute values

## Quality Control Indicators

### Expected Ranges
- **Delta/Slow Power**: Highest amplitude rhythm
- **Theta Power**: Moderate, task-dependent
- **Beta Power**: Lowest amplitude, state-dependent
- **Spike Rate**: <1/second in normal EEG

### Abnormal Patterns
- **All powers near zero**: Electrode problem
- **Extremely high spike rate**: Artifact contamination
- **Inverted ratios**: Check filter implementation
- **No spatial variation**: Possible reference issue

## Regional Analysis

Rhythmic features can be calculated for specific regions:
- **Frontal theta**: Executive function
- **Temporal spikes**: Epileptiform activity
- **Occipital beta**: Visual processing
- **Central beta**: Motor activity
- Features follow pattern: `{prefix}_{region}_rhythmic_{feature}`

## Relationship to Other Features

### Complementary to PSD Features
- Rhythmic: Time-domain, specific bands
- PSD: Frequency-domain, full spectrum
- Both capture power but different methods

### Distinct from Wavelet Features
- Rhythmic: Fixed frequency bands
- Wavelet: Multi-resolution analysis
- Rhythmic better for known bands

### Enhancement of Time Features
- Adds frequency-specific information
- Spike detection augments statistical measures
- Ratios provide normalized comparisons